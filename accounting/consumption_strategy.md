## План как не терять сообщения в акаунтинге
- для защиты от двойных списаний/начислений необходимо пользоваться ключом идемпотентности 
и для всех операций начисления/списания брать лок на счёт/счета
- завести dlq (как таблицу в постгресе, как отдельный топик в кафке) для сообщений которые не смогли распарсить / 
невалидных с точки зрения схемы сообщений
- при получении сообщения которое не смогли распарсить сразу отправлять его в dlq и комитить оффсет, 
при невозможности записать сообщение в dlq, продолжать консюминг данного сообщения
- добавить алёртинг и метрики на количество необработанных сообщений находящихся в dlq
- для сообщений которые мы не смогли обработать по причинам связанным с внутренними ошибками сервиса 
(не смогли записать в базу, etc) необходимо не комитить оффсет, а продолжать пытаться обработать данное сообщение невзирая на рост лага
- необходимо добавить алерт на рост лага топика
- так же можно рассмотреть вариант с ретрай топиком, 
некоторые кафка библиотеки умеют считать количество попыток обработки сообщения(github.com/Shopify/sarama), 
после определённого числа попыток обработать сообщение, закомитить оффсет и отправить сообщение в ретрай топик для дальнейших попыток обработки 
и проалертить о неуспешной попытке обработки
