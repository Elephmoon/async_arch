# async_arch
## Awesome Task Exchange System aka (aTES) UberPopug Inc

## Общее описание архитектуры

Верхнеуровнево проект состоит из четырёх основных сервисов:
- сервиса авторизации/регистрации пользователей (auth-service)
- сервиса работы с задачами (task-tracker)
- сервиса работы со счетами пользователей (accounting)
- сервиса аналитики (analytics)

### Сервис task-tracker
- даёт возможность создавать задачи 
- даёт возможность рандмомно переасайнить все задачи на рандмоных пользователей
- показывает пользователю список заасайненых на него задач
- даёт возможность пользователю отметить задачу выполненной
- списывает/начисляет деньги за задачу через сервис accounting
- потребляет информацию о пользовательских ролях из кафки сервиса auth-service
- поставляет информацию в аналитический топик кафки  

**краткое описание api**
```
// запрос на создание задачи
CreateTaskRequest {
    descritption // описание задачи
}

// запрос на реасайн всех текущих задач
ReasigneTasksRequest {
    user_id // id пользователя вызвашего реафсайн всех задач
}
```

### Сервис accoutning
- хранит балансы пользователей
- хранит аудитлог изменений балансов
- выводит статистику зарабтанных компанией денег за день
- выполняет процедуру закрытия дня (считает сколько денег заработал каждый пользователь, отправляет чеки на почту, обнуляет положительный баланс, отрицательный переносит на следующий день)
- поставляет аудитлог изменений балансов в аналитическую кафку
- потребляет информацию о новых пользователях из кафки сервиса auth-service

**краткое описание api**
```
// запрос на изменение баланса
Charge {
    // тип изменения баланса
    ChargeType charge_type
    // id задачи по результатам которой изменям баланс
    task_id
    // id пользователя которому изменяем баланс
    user_id
}

// типы изменений баланса
ChargeType enum {
    // увеличиваем баланс при выполнении задачи
    Credit
    // уменьшаем баланс при асайне задачи
    Debit
}

```
